COMMENT handle any disconnected connections param responses the list of responses that completed with the disconnection param now the current time FUNCTION SPECIFIER private TYPE void NAME void NAME handle disconnections PARAMETER LIST list client response responses long now PARAMETER list client response responses TYPE list client response NAME list client response NAME list ARGUMENT LIST ARGUMENT NAME client response NAME responses PARAMETER long now TYPE long NAME long NAME now BLOCK FOR for map entry string channel state entry this selector disconnected entry set string node entry get key log debug node disconnected node process disconnection responses node now entry get value CONTROL map entry string channel state entry this selector disconnected entry set INIT map entry string channel state entry this selector disconnected entry set TYPE map entry string channel state NAME map entry string channel state NAME map NAME entry string channel state NAME entry ARGUMENT LIST ARGUMENT NAME string ARGUMENT NAME channel state NAME entry RANGE this selector disconnected entry set EXPR this selector disconnected entry set CALL this selector disconnected NAME this selector disconnected NAME this NAME selector NAME disconnected ARGUMENT LIST CALL entry set NAME entry set ARGUMENT LIST BLOCK DECL STMT TYPE string NAME string NAME node INIT entry get key EXPR entry get key CALL entry get key NAME entry get key NAME entry NAME get key ARGUMENT LIST EXPR log debug node disconnected node CALL log debug node disconnected node NAME log debug NAME log NAME debug ARGUMENT LIST ARGUMENT EXPR node disconnected ARGUMENT EXPR node NAME node EXPR process disconnection responses node now entry get value CALL process disconnection responses node now entry get value NAME process disconnection ARGUMENT LIST ARGUMENT EXPR responses NAME responses ARGUMENT EXPR node NAME node ARGUMENT EXPR now NAME now ARGUMENT EXPR entry get value CALL entry get value NAME entry get value NAME entry NAME get value ARGUMENT LIST COMMENT we got a disconnect so we should probably refresh our metadata and see if that broker is dead IF if this selector disconnected size metadata updater request update CONDITION this selector disconnected size EXPR this selector disconnected size CALL this selector disconnected NAME this selector disconnected NAME this NAME selector NAME disconnected ARGUMENT LIST CALL size NAME size ARGUMENT LIST THEN metadata updater request update BLOCK EXPR metadata updater request update CALL metadata updater request update NAME metadata updater request update NAME metadata updater NAME request update ARGUMENT LIST handle any disconnected connections root ROOT handle det connections any amod connections disconnected dobj handle connections param responses the list of responses that completed with the disconnection root ROOT responses compound responses param det list the dep responses list case responses of nmod of list responses nsubj completed responses ref responses that acl relcl responses completed case disconnection with det disconnection the nmod with completed disconnection param now the current time root ROOT time nsubj time param advmod time now det time the amod time current private JJ void NN handle VB disconnections NNS root ROOT handle dobj handle disconnections list NN client NN response NN root ROOT response compound response client responses NNS long RB now RB for IN map NN entry NN root ROOT entry compound entry map string NN channel NN state NN root ROOT state compound state channel entry NN this DT selector NN disconnected VBD entry NN set NN root ROOT set compound set entry string NN node NN entry NN get VB key JJ root ROOT get nsubj get entry xcomp get key log NN debug NN root ROOT debug compound debug log node NN disconnected VBN node NN process NN disconnection NN root ROOT disconnection compound disconnection process responses NNS node NN now RB entry NN get VB value NN root ROOT get nsubj get entry dobj get value we got a disconnect so we should probably refresh our metadata and see if that broker is dead root ROOT got nsubj got we det disconnect a dobj got disconnect mark refresh so nsubj refresh we nsubj see we aux refresh should advmod refresh probably advcl so disconnect refresh nmod poss metadata our dobj refresh metadata cc refresh and advcl so disconnect see conj and refresh see mark dead if det broker that nsubj dead broker cop dead is advcl if see dead if IN this DT selector NN disconnected VBD size NN metadata NN updater NN request NN update VBP root ROOT update compound request metadata compound request updater nsubj update request connections disconnect ANTONYM ANTONYM connections disconnection ANTONYM ANTONYM current dead ANTONYM ANTONYM got see ANTONYM ANTONYM map is ANTONYM ANTONYM string got ANTONYM ANTONYM completed dead SYNONYM SYNONYM
